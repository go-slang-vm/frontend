"use strict";(globalThis.webpackChunkfrontend=globalThis.webpackChunkfrontend||[]).push([[80396],{24526:(e,n,i)=>{i.d(n,{Z:()=>l});var t=i(75621),s=i(44925),o=i(47313),r=i(46417);const l=e=>((0,o.useEffect)((()=>{var n;null===(n=e.loadContentDispatch)||void 0===n||n.call(e)}),[]),(0,r.jsx)("div",{className:"ContentDisplay row center-xs",children:(0,r.jsx)("div",{className:(e.fullWidth?"col-md-12":"col-md-10 col-xs-11")+" contentdisplay-content-parent",children:(0,r.jsx)(t.Z,{className:"contentdisplay-content",elevation:s.u.THREE,children:e.display})})}))},80396:(e,n,i)=>{i.r(n),i.d(n,{Component:()=>m,default:()=>I});i(94463);var t=i(43076),s=i(59568),o=i(80145),r=i(70352),l=i(92421),d=i(47313),a=i(66135),c=i(58467),h=i(31197),x=i(24526),j=i(60013),p=i(5793),u=i(73958),y=i(95954),g=i(46417);const C=({headers:e,stories:n,storyActions:i})=>(0,g.jsxs)(l.iA,{marginTop:"mt-10",children:[(0,g.jsx)(l.ss,{children:(0,g.jsx)(l.SC,{children:e.map((({id:e,header:n})=>(0,g.jsx)(l.xs,{children:n},e)))})}),(0,g.jsx)(l.RM,{children:n.map((e=>{const{id:n,authorName:t,isPinned:s,title:d,content:a}=e;return(0,g.jsxs)(l.SC,{children:[(0,g.jsx)(l.pj,{children:t}),(0,g.jsx)(l.pj,{children:(0,g.jsxs)(l.kC,{justifyContent:"justify-start",children:[s&&(0,g.jsx)(l.JO,{icon:()=>(0,g.jsx)(o.I,{icon:r.d.PIN})}),(0,g.jsx)(l.xv,{children:d})]})}),(0,g.jsx)(l.pj,{children:(0,g.jsx)(l.xv,{children:a.replaceAll(/\s+/g," ").length<=35?a.replaceAll(/\s+/g," "):a.split(/\s+/).reduce(((e,n)=>e.length+n.length<=35?e+" "+n:e),"")+"\u2026"})}),(0,g.jsx)(l.pj,{children:i(e)})]},n)}))})]});var f=i(2135);const v=({storyId:e,handleDeleteStory:n,canView:i=!1,canEdit:t=!1,canDelete:s=!1,canPin:d=!1,isPinned:a=!1,handleTogglePin:c=(()=>{}),handleMovePinUp:h=(()=>{}),handleMovePinDown:x=(()=>{})})=>(0,g.jsxs)(l.kC,{justifyContent:"justify-start",spaceX:"space-x-2",children:[i&&(0,g.jsx)(f.rU,{to:`./view/${e}`,children:(0,g.jsx)(l.JO,{tooltip:"View",icon:()=>(0,g.jsx)(o.I,{icon:r.d.EyeOpen}),variant:"light",color:"green"})}),t&&(0,g.jsx)(f.rU,{to:`./edit/${e}`,children:(0,g.jsx)(l.JO,{tooltip:"Edit",icon:()=>(0,g.jsx)(o.I,{icon:r.d.EDIT}),variant:"light",color:"sky"})}),d&&a&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("button",{style:{padding:0},onClick:()=>h(e),children:(0,g.jsx)(l.JO,{tooltip:"Reorder up",icon:()=>(0,g.jsx)(o.I,{icon:r.d.ARROW_UP}),variant:"light",color:"pink"})}),(0,g.jsx)("button",{style:{padding:0},onClick:()=>x(e),children:(0,g.jsx)(l.JO,{tooltip:"Reorder down",icon:()=>(0,g.jsx)(o.I,{icon:r.d.ARROW_DOWN}),variant:"light",color:"pink"})})]}),d&&(0,g.jsx)("button",{style:{padding:0},onClick:()=>c(e),children:(0,g.jsx)(l.JO,{tooltip:a?"Unpin":"Pin",icon:()=>(0,g.jsx)(o.I,{icon:a?r.d.EXCLUDE_ROW:r.d.PIN}),variant:"light",color:"indigo"})}),s&&(0,g.jsx)("button",{style:{padding:0},onClick:()=>n(e),children:(0,g.jsx)(l.JO,{tooltip:"Delete",icon:()=>(0,g.jsx)(o.I,{icon:r.d.TRASH}),variant:"light",color:"red"})})]}),P=[{id:"author",header:"Author"},{id:"title",header:"Title"},{id:"content",header:"Content"},{id:"actions",header:"Actions"}],k=()=>{const[e,n]=(0,d.useState)(""),i=(0,c.s0)(),f=(0,a.I0)(),{userId:k,role:m}=(0,p.ix)((e=>e.stories)),I=(0,p.ix)((e=>!e.stories.groupId)),b=!!k,O=(0,d.useCallback)((()=>i("./new")),[i]),S=(0,d.useCallback)((async e=>{await(0,j.pG)({contents:(0,g.jsx)("p",{children:"Are you sure you want to delete this story?"}),positiveIntent:"danger",positiveLabel:"Delete"})&&f((0,u.deleteStory)(e))}),[f]),w=(0,p.ix)((e=>e.stories.storyList)),D=(0,d.useCallback)((e=>{const n=w.find((n=>n.id===e)),i=w.filter((e=>e.isPinned)).length,t={...n,isPinned:!n.isPinned,pinOrder:n.isPinned?null:i};f((0,u.saveStory)(t,e))}),[f,w]),A=(0,d.useCallback)((e=>{const n=w.findIndex((n=>n.id===e));if(0===n)return;[{...w[n],pinOrder:n-1},{...w[n-1],pinOrder:n}].forEach((e=>f((0,u.saveStory)(e,e.id))))}),[f,w]),E=(0,d.useCallback)((e=>{const n=w.findIndex((n=>n.id===e));if(n===w.filter((e=>e.isPinned)).length-1)return;[{...w[n],pinOrder:n+1},{...w[n+1],pinOrder:n}].forEach((e=>f((0,u.saveStory)(e,e.id))))}),[f,w]);return I?(0,g.jsx)(x.Z,{display:(0,g.jsx)(t.t,{icon:r.d.ERROR,title:"Disabled",description:"Stories has been disabled for this course."})}):(0,g.jsx)(x.Z,{loadContentDispatch:()=>f((0,u.getStoriesList)()),display:(0,g.jsxs)(l.Zb,{children:[(0,g.jsxs)(l.kC,{justifyContent:"justify-between",children:[(0,g.jsxs)(l.kC,{justifyContent:"justify-start",spaceX:"space-x-6",children:[(0,g.jsx)(l.Dx,{children:"All Stories"}),b&&(0,g.jsx)(s.z,{onClick:O,icon:r.d.PLUS,children:"Add Story"})]}),(0,g.jsx)(l.oi,{maxWidth:"max-w-xl",icon:()=>(0,g.jsx)(o.I,{icon:r.d.SEARCH,style:{marginLeft:"0.75rem"}}),placeholder:"Search for author...",onChange:e=>n(e.target.value)})]}),(0,g.jsx)(C,{headers:P,stories:w.map((e=>({...e,content:(0,y.Wx)(e.content).content}))).filter((n=>n.isPinned||n.authorName.toLowerCase().includes(e.toLowerCase()))),storyActions:e=>{const n=k===e.authorId,i=m===h.xo.Moderator||m===h.xo.Admin;return(0,g.jsx)(v,{storyId:e.id,handleDeleteStory:S,handleTogglePin:D,handleMovePinUp:A,handleMovePinDown:E,canView:!0,canEdit:n||i,canDelete:n||i,canPin:i,isPinned:e.isPinned})}})]})})},m=k;m.displayName="Stories";const I=k},94463:()=>{}}]);